<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat Categories</title>
    <style>
        .circle {
            display: flex;
            align-items: center;
        }
        .avator {
            width: 100px;
            height: 100px;
            border-radius: 50%;
        }
        .navbar {
            display: flex;
            justify-content: space-around;
        }
        .navbar .item {
            padding: 10px;
            cursor: pointer;
        }
        .navbar .active {
            font-weight: bold;
        }
        .catitem {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .cat-name {
            margin-left: 10px;
        }
        .divLine {
            height: 1px;
            background-color: lightgray;
            width: 100%;
            margin: 10px 0;
        }
        .body {
            margin: 10px 0;
        }
        .bodybold {
            font-weight: bold;
        }
        .search-container {
            max-width: 800px;
            margin: 20px auto;
            text-align: center;
        }
        .search-input {
            width: 60%;
            padding: 12px 20px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 25px;
            margin-right: 10px;
            outline: none;
            transition: border-color 0.3s;
        }
        .search-input:focus {
            border-color: #4CAF50;
        }
        .search-button {
            padding: 12px 25px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .search-button:hover {
            background-color: #45a049;
        }
        .search-results {
            max-width: 800px;
            margin: 20px auto;
            display: none;
        }
        .cat-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .cat-card:hover {
            transform: translateY(-3px);
        }
        .no-results {
            text-align: center;
            color: #666;
            padding: 20px;
        }
        .detail-container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        .back-button {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 20px;
        }
        .back-button:hover {
            background-color: #45a049;
        }
        .cat-detail {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .detail-image {
            width: 300px;
            height: 300px;
            border-radius: 8px;
            object-fit: cover;
            display: block;
            margin: 0 auto;
        }
        .detail-name {
            text-align: center;
            margin: 20px 0;
            color: #333;
        }
        .detail-info {
            color: #666;
            line-height: 1.6;
        }
        .detail-info p {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="search-container">
        <input type="text" id="searchInput" class="search-input" placeholder="搜索猫咪名字或描述...">
        <button onclick="searchCats()" class="search-button">搜索</button>
    </div>
    <div id="searchResults" class="search-results"></div>

    
    <div class="navbar">
        <span class="item" onclick="navbarTap(0)">在校</span>
        <span class="item" onclick="navbarTap(1)">毕业</span>
        <span class="item" onclick="navbarTap(2)">休学</span>
        <span class="item" onclick="navbarTap(3)">喵星</span>
    </div>

    <div id="content">
        <!-- 在校 -->
        <div id="onCampus" style="display: none;">
            <a onclick="showCatDetails('玳瑁及三花')">
                <div class="catitem">
                    <img class="avator" src="./images/山花.png" alt="Avatar">
                    <div class="cat-name">三花和玳瑁</div>
                </div>
            </a>
            <div class="divLine"></div>

            <a onclick="showCatDetails('橘猫及橘白')">
                <div class="catitem">
                    <img class="avator" src="./images/黄小孙女.png" alt="Avatar">
                    <div class="cat-name">橘猫和橘白</div>
                </div>
            </a>
            <div class="divLine"></div>

            <a onclick="showCatDetails('纯色')">
                <div class="catitem">
                    <img class="avator" src="./images/薏米.png" alt="Avatar">
                    <div class="cat-name">纯色</div>
                </div>
            </a>
            <div class="divLine"></div>

            <a onclick="showCatDetails('奶牛')">
                <div class="catitem">
                    <img class="avator" src="./images/英杰.png" alt="Avatar">
                    <div class="cat-name">奶牛</div>
                </div>
            </a>
            <div class="divLine"></div>

            <a onclick="showCatDetails('狸花')">
                <div class="catitem">
                    <img class="avator" src="./images/大狸.png" alt="Avatar">
                    <div class="cat-name">狸花</div>
                </div>
            </a>
            <div class="divLine"></div>

            <a onclick="showCatDetails('所有')">
                <div class="catitem">
                    <img class="avator" src="./images/huihui.png" alt="Avatar">
                    <div class="cat-name">所有</div>
                </div>
            </a>
            <div class="divLine"></div>

            <div class="body">
                流浪猫客观上会对校内野生物种（主要是部分鸟类）产生负面影响。如果目击到流浪猫正在捕猎，我们鼓励同学们采取安全手段加以阻止。
            </div>
            <div style="display: flex;margin-top:50px;">
                <div style="background-color: lightgray; width: 100%; height: 1px;"></div>
            </div>
            <div class="body">若您在校内偶遇流浪猫，<span class="bodybold">切记</span>人类的食物<span class="bodybold">不要</span>喂给流浪猫！</div>
            <div class="body">🚫<span class="bodybold">巧克力、葡萄制品、大葱、洋葱</span>等食品对猫<span class="bodybold">有毒</span>，可能会引起急性肾衰竭，切<span class="bodybold">不可以</span>喂食！</div>
            <div class="body">🚫<span class="bodybold">火腿肠</span>和<span class="bodybold">牛奶</span>也并<span class="bodybold">不适合</span>猫咪，会引起肠胃反应，造成腹泻等状况。</div>
            <div class="body">🚫酸性的各类水果、香辛料制的肉类、乌贼等海产也<span class="bodybold">均不适合</span>猫咪食用。</div>
            <div class="body">猫常见的较合适的食物有猫粮、猫罐头、以及其它一些猫咪零食。</div>
        </div>

        <!-- 毕业 -->
        <div id="graduated" style="display: none;">
            <!-- 这里需要使用JavaScript来实现循环渲染 -->
        </div>

        <!-- 休学 -->
        <div id="onLeave" style="display: none;">
            <!-- 这里需要使用JavaScript来实现循环渲染 -->
        </div>

        <!-- 喵星 -->
        <div id="dead" style="display: none;">
            <!-- 这里需要使用JavaScript来实现循环渲染 -->
        </div>

        <!-- 三花和玳瑁详细信息 -->
        <div id="daiMaoSanHuaDetails" style="display: none;">
            <div class="body">这里是三花和玳瑁的详细信息</div>
            <div id="daiMaoSanHuaList"></div>
        </div>

        <!-- 添加其他分类的详细信息容器 -->
        <div id="catDetails" style="display: none;">
            <div style="display: flex; align-items: center; margin-bottom: 20px;">
                <button onclick="goBack()" style="padding: 8px 16px; margin-right: 10px; cursor: pointer;">返回</button>
                <div class="body">这里是<span id="categoryTitle"></span>的详细信息</div>
            </div>
            <div id="catList"></div>
        </div>

        <!-- 添加猫咪详情页面 -->
        <div id="catDetailPage" style="display: none;">
            <div class="detail-container">
                <button onclick="backToMain()" class="back-button">返回</button>
                <div class="cat-detail">
                    <img id="catDetailImage" class="detail-image" src="" alt="猫咪照片">
                    <h2 id="catDetailName" class="detail-name"></h2>
                    <div class="detail-info">
                        <p>分类：<span id="catDetailClassification"></span></p>
                        <p id="catDetailInfo"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const navbar = ["在校", "毕业", "休学", "喵星"];
        let currentTab = 0;

        // 添加变量记录上一级页面状态
        let previousView = {
            type: 'main', // 'main' 或 'category'
            classification: '' // 当前查看的分类
        };

        function imageTap() {
            // 处理点击头像的逻辑
        }

        function navbarTap(index) {
            currentTab = index;
            document.querySelectorAll('.navbar .item').forEach((item, i) => {
                item.classList.toggle('active', i === currentTab);
            });
            document.querySelectorAll('#content > div').forEach((div, i) => {
                div.style.display = i === currentTab ? 'block' : 'none';
            });
        }

        // 修改猫咪数据，为每只猫添加简单描述
        const fostered_cat = [
            { 
                _id: 1, 
                name: "英杰", 
                classification: "玳瑁及三花",
                info: "英杰是一只非常温顺的公猫，毛色为黑白相间。性格活泼开朗，特别喜欢和同学互动。经常在图书馆附近活动，是学校里最受欢迎的猫咪之一。"
            },
            { 
                _id: 2, 
                name: "山花", 
                classification: "玳瑁及三花",
                info: "山花是一只美丽的三花猫，性格温和。她喜欢在教学楼周围晒太阳，偶尔会和同学玩耍。她的叫声特别好听，就像在唱歌一样。"
            }
        ];

        const unknown_cat = [
            { 
                _id: 3, 
                name: "大狸", 
                classification: "纯色",
                info: "大狸是一只帅气的黑猫，独来独往的性格让他显得很酷。虽然不太爱和人亲近，但经常在食堂后面守护着这片区域，是位尽职的'保安'。"
            }
        ];

        const dead_cat = [
            { 
                _id: 4, 
                name: "薏米", 
                classification: "纯色",
                info: "薏米曾是校园里最受欢迎的猫咪之一，她有着漂亮的白色毛发和温柔的性格。她为校园带来了很多欢乐，永远活在大家的记忆中。"
            }
        ];

        const url = "./images/";

        function showCatDetails(classification) {
            // 记录上一级状态
            previousView = {
                type: 'main',
                classification: classification
            };

            // 隐藏所有标签页内容
            document.querySelectorAll('#content > div').forEach(div => {
                div.style.display = 'none';
            });
            
            // 显示对应分类的详细信息
            document.getElementById('catDetails').style.display = 'block';
            
            // 更新分类标题
            document.getElementById('categoryTitle').textContent = classification;
            
            // 修改这里：从所有数组中筛选对应分类的猫咪
            const data = classification === '所有' 
                ? [...fostered_cat, ...unknown_cat, ...dead_cat]
                : [...fostered_cat, ...unknown_cat, ...dead_cat].filter(cat => cat.classification === classification);
            
            renderCats(data, 'catList');
        }

        function renderCats(data, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            data.forEach(item => {
                const div = document.createElement('div');
                div.innerHTML = `
                    <div class="catitem" onclick="showCatDetailInfo(${item._id})" data-_id="${item._id}">
                        <img class="avator" src="${url}${item.name}.png" alt="Avatar">
                        <div class="cat-name">${item.name}</div>
                    </div>
                    <div class="divLine"></div>
                `;
                container.appendChild(div);
            });
        }

        function showCatDetailInfo(id) {
            const cat = [...fostered_cat, ...unknown_cat, ...dead_cat].find(c => c._id === id);
            if (!cat) return;

            // 如果是从分类页面点击进来的，记录分类页面状态
            if (document.getElementById('catDetails').style.display === 'block') {
                previousView = {
                    type: 'category',
                    classification: document.getElementById('categoryTitle').textContent
                };
            }

            // 隐藏所有其他内容
            document.querySelectorAll('#content > div').forEach(div => {
                div.style.display = 'none';
            });

            // 显示详情页
            document.getElementById('catDetailPage').style.display = 'block';
            
            // 更新详情内容
            document.getElementById('catDetailName').textContent = cat.name;
            document.getElementById('catDetailImage').src = `.${url}${cat.name}.png`;
            document.getElementById('catDetailClassification').textContent = cat.classification;
            document.getElementById('catDetailInfo').textContent = cat.info || '暂无详细信息';
        }

        navbarTap(0); // 初始化显示在校内容
        renderCats(fostered_cat, 'graduated');
        renderCats(unknown_cat, 'onLeave');
        renderCats(dead_cat, 'dead');

        function editCat(id) {
            // 处理长按编辑猫的逻辑
        }

        function goBack() {
            // 隐藏分类详情
            document.getElementById('catDetails').style.display = 'none';
            // 显示当前选中标签页的内容
            document.querySelectorAll('#content > div').forEach((div, i) => {
                div.style.display = i === currentTab ? 'block' : 'none';
            });
        }

        // 添加搜索功能
        function searchCats() {
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            const searchResults = document.getElementById('searchResults');
            const mainContent = document.getElementById('content');

            if (!searchInput) {
                searchResults.style.display = 'none';
                mainContent.style.display = 'block';
                return;
            }

            // 合并所有猫咪数据
            const allCats = [...fostered_cat, ...unknown_cat, ...dead_cat];

            const filteredCats = allCats.filter(cat => 
                cat.name.toLowerCase().includes(searchInput) || 
                cat.classification.toLowerCase().includes(searchInput)
            );

            searchResults.innerHTML = '';
            
            if (filteredCats.length > 0) {
                filteredCats.forEach(cat => {
                    const div = document.createElement('div');
                    div.className = 'cat-card';
                    div.innerHTML = `
                        <div class="catitem">
                            <img class="avator" src=".${url}${cat.name}.png" alt="Avatar">
                            <div class="cat-info">
                                <h3>${cat.name}</h3>
                                <p>分类: ${cat.classification}</p>
                            </div>
                        </div>
                    `;
                    div.onclick = () => {
                        // 从搜索结果点击时，设置返回到主页
                        previousView = {
                            type: 'main',
                            classification: ''
                        };
                        showCatDetailInfo(cat._id);
                    };
                    searchResults.appendChild(div);
                });
                searchResults.style.display = 'block';
                mainContent.style.display = 'none';
            } else {
                searchResults.innerHTML = '<div class="no-results">未找到相关猫咪</div>';
                searchResults.style.display = 'block';
                mainContent.style.display = 'none';
            }
        }

        // 添加搜索结果的样式
        const style = document.createElement('style');
        style.textContent = `
            .cat-card .catitem {
                padding: 15px;
                border-radius: 8px;
                background-color: #fff;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                margin-bottom: 10px;
                cursor: pointer;
                transition: transform 0.2s;
            }
            .cat-card .catitem:hover {
                transform: translateY(-3px);
            }
            .cat-card .cat-info {
                margin-left: 15px;
            }
            .cat-card .cat-info h3 {
                margin: 0 0 5px 0;
                color: #333;
            }
            .cat-card .cat-info p {
                margin: 0;
                color: #666;
            }
            .no-results {
                text-align: center;
                padding: 20px;
                color: #666;
                background-color: #f9f9f9;
                border-radius: 8px;
            }
        `;
        document.head.appendChild(style);

        // 添加输入框回车搜索功能
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchCats();
            }
        });

        // 修改返回主页面的函数
        function backToMain() {
            document.getElementById('catDetailPage').style.display = 'none';
            
            if (previousView.type === 'category') {
                // 返回到分类页面
                showCatDetails(previousView.classification);
            } else {
                // 返回到主页面
                navbarTap(currentTab);
            }
        }
    </script>
</body>
</html>
